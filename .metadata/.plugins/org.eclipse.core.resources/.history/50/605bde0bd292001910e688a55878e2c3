package br.edu.ifpe.igarassu.ipi.poo.model.controller;

import java.io.IOException;
import java.io.OutputStream;
import java.util.Map;

import com.sun.net.httpserver.HttpExchange;

import br.edu.ifpe.igarassu.ipi.poo.user.User;

public class AddUserHandler extends AbstractHandler {

	@Override
	public void handle(HttpExchange t) throws IOException {
		printRequestInfo(t);
		
 
		Map<String, Object> parsePostParameters = parsePostParameters(t);
		
		User newUser = new User(super.getDAOUsers().size(), parsePostParameters.get("name").toString(), parsePostParameters.get("passwod").toString());
		super.getDAOUsers().add(newUser);

		System.out.println("add user" + newUser.getName() + " | " + newUser.getPassword());
		String response = "add user";
		t.sendResponseHeaders(200, response.length());
		OutputStream os = t.getResponseBody();
		os.write(response.getBytes());
		os.close();

	}

}
