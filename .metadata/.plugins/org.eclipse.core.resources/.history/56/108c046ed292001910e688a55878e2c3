package br.edu.ifpe.igarassu.ipi.poo.model.controller;

import java.io.IOException;
import java.io.OutputStream;
import java.util.Map;

import com.sun.net.httpserver.HttpExchange;

import br.edu.ifpe.igarassu.ipi.poo.user.User;

public class AddUserHandler extends AbstractHandler {

	@Override
	public void handle(HttpExchange handler) throws IOException {
		printRequestInfo(handler);
 
		Map<String, Object> parameters = parsePostParameters(handler);
		
		User newUser = new User(super.getDAOUsers().size(), parameters.get("name").toString(), parameters.get("passwod").toString());
		super.getDAOUsers().add(newUser);

		System.out.println("add user" + newUser.getName() + " | " + newUser.getPassword());
		String response = "add user";
		handler.sendResponseHeaders(200, response.length());
		OutputStream os = handler.getResponseBody();
		os.write(response.getBytes());
		os.close();

	}

}
